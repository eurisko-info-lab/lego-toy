seq DLang lang ident Arith unit := DPiece piece ident Term DGrammar ident term ::= alt ref ident zero | alt ref ident succ | alt ref ident add | alt ref ident mul | ref ident pred ; DGrammar ident zero ::= lit string "(" lit string "Z" lit string ")" ; DGrammar ident succ ::= lit string "(" lit string "S" ref ident term lit string ")" ; DGrammar ident add ::= lit string "(" lit string "add" ref ident term ref ident term lit string ")" ; DGrammar ident mul ::= lit string "(" lit string "mul" ref ident term ref ident term lit string ")" ; DGrammar ident pred ::= lit string "(" lit string "pred" ref ident term lit string ")" ; DPiece piece ident Rec DGrammar ident rec ::= alt ref ident fib | ref ident fact ; DGrammar ident fib ::= lit string "(" lit string "fib" ref ident term lit string ")" ; DGrammar ident fact ::= lit string "(" lit string "fact" ref ident term lit string ")" ; DRule rule ident add_zero : var $ ident n ~> var $ ident n unit ; DRule rule ident add_succ : con ( ident S con ( ident add var $ ident m var $ ident n ) ) ~> con ( ident S con ( ident add var $ ident m var $ ident n ) ) unit ; DRule rule ident mul_zero : con ( ident Z ) ~> con ( ident Z ) unit ; DRule rule ident mul_succ : con ( ident add var $ ident n con ( ident mul var $ ident m var $ ident n ) ) ~> con ( ident add var $ ident n con ( ident mul var $ ident m var $ ident n ) ) unit ; DRule rule ident pred_zero : con ( ident Z ) ~> con ( ident Z ) unit ; DRule rule ident pred_succ : var $ ident n ~> var $ ident n unit ; DRule rule ident fib_zero : con ( ident Z ) ~> con ( ident Z ) unit ; DRule rule ident fib_one : con ( ident S con ( ident Z ) ) ~> con ( ident S con ( ident Z ) ) unit ; DRule rule ident fib_succ : con ( ident add con ( ident fib con ( ident S var $ ident n ) ) con ( ident fib var $ ident n ) ) ~> con ( ident add con ( ident fib con ( ident S var $ ident n ) ) con ( ident fib var $ ident n ) ) unit ; DRule rule ident fact_zero : con ( ident S con ( ident Z ) ) ~> con ( ident S con ( ident Z ) ) unit ; DRule rule ident fact_succ : con ( ident mul con ( ident S var $ ident n ) con ( ident fact var $ ident n ) ) ~> con ( ident mul con ( ident S var $ ident n ) con ( ident fact var $ ident n ) ) unit ; DTest test string "add_0_0" : con ( ident add con ( ident Z ) con ( ident Z ) ) ~~> con ( ident Z ) ; DTest test string "add_1_2" : con ( ident add con ( ident S con ( ident Z ) ) con ( ident S con ( ident S con ( ident Z ) ) ) ) ~~> con ( ident S con ( ident S con ( ident S con ( ident Z ) ) ) ) ; DTest test string "mul_2_3" : con ( ident mul con ( ident S con ( ident S con ( ident Z ) ) ) con ( ident S con ( ident S con ( ident S con ( ident Z ) ) ) ) ) ~~> con ( ident S con ( ident S con ( ident S con ( ident S con ( ident S con ( ident S con ( ident Z ) ) ) ) ) ) ) ; DTest test string "pred_3" : con ( ident pred con ( ident S con ( ident S con ( ident S con ( ident Z ) ) ) ) ) ~~> con ( ident S con ( ident S con ( ident Z ) ) ) ; DTest test string "fib_0" : con ( ident Z ) ~~> con ( ident Z ) ; DTest test string "fib_1" : con ( ident S con ( ident Z ) ) ~~> con ( ident S con ( ident Z ) ) ; DTest test string "fib_2" : con ( ident fib con ( ident S con ( ident S con ( ident Z ) ) ) ) ~~> con ( ident S con ( ident Z ) ) ; DTest test string "fib_3" : con ( ident fib con ( ident S con ( ident S con ( ident S con ( ident Z ) ) ) ) ) ~~> con ( ident S con ( ident S con ( ident Z ) ) ) ; DTest test string "fact_0" : con ( ident S con ( ident Z ) ) ~~> con ( ident S con ( ident Z ) ) ; DTest test string "fact_1" : con ( ident fact con ( ident S con ( ident Z ) ) ) ~~> con ( ident S con ( ident Z ) ) ; DTest test string "fact_2" : con ( ident fact con ( ident S con ( ident S con ( ident Z ) ) ) ) ~~> con ( ident S con ( ident S con ( ident Z ) ) ) ; DTest test string "fact_3" : con ( ident fact con ( ident S con ( ident S con ( ident S con ( ident Z ) ) ) ) ) ~~> con ( ident S con ( ident S con ( ident S con ( ident S con ( ident S con ( ident S con ( ident Z ) ) ) ) ) ) ) ;